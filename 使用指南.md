# 轻小说爬虫使用指南

## 🎉 恭喜！程序已成功安装并升级完成

您的轻小说爬虫程序已经成功安装并通过测试。第一卷的EPUB文件已经生成，包含了9个章节和40张插图。

### ✨ 最新功能升级
- **🖼️ 图片完美嵌入**：插图现在正确显示在EPUB中
- **🎨 专业阅读样式**：全新的CSS设计，提供优雅的阅读体验
- **🤖 智能文本识别**：自动识别对话、内心独白、旁白等不同文本类型
- **📱 响应式设计**：支持不同屏幕尺寸和深色模式
- **⚡ 增强的内容处理**：更智能的段落分割和格式化

## 📁 文件结构

```
PythonProject_GetFiction/
├── output/                                    # EPUB输出目录
│   ├── 我的青春恋爱物语果然有问题_第一卷.epub    # 生成的EPUB文件（含图片）
│   ├── 我的青春恋爱物语果然有问题_功能演示卷.epub # 功能演示文件
│   └── 我的青春恋爱物语果然有问题_测试卷册.epub  # 测试文件
├── data/images/                               # 下载的图片
│   ├── 第一卷_image_001.jpg                   # 插图文件
│   └── ...                                   # 更多图片
├── logs/                                      # 日志文件
└── ...                                       # 程序源码
```

## 🚀 快速开始

### 1. 爬取所有卷册
```bash
python main.py
```

### 2. 爬取指定卷册
```bash
# 爬取第一卷和第二卷
python main.py --volumes "第一卷" "第二卷"

# 爬取前三卷
python main.py -v "第一卷" "第二卷" "第三卷"

# 爬取特定卷册（支持部分匹配）
python main.py -v "第6.5卷" "第7.5卷"
```

### 3. 测试网络连接
```bash
python main.py --test
```

### 4. 功能演示和测试
```bash
python demo_features.py                     # 生成功能演示EPUB
python test_epub.py                         # 测试EPUB生成功能
```

## 📖 详细使用说明

### 命令行参数

| 参数 | 简写 | 说明 | 示例 |
|------|------|------|------|
| `--volumes` | `-v` | 指定要爬取的卷册 | `--volumes "第一卷" "第二卷"` |
| `--test` | `-t` | 仅测试网络连接 | `--test` |
| `--help` | `-h` | 显示帮助信息 | `--help` |

### 卷册列表

程序已检测到以下19个卷册：
1. 第一卷 ✅ (已测试成功)
2. 第二卷
3. 第三卷
4. 第四卷
5. 第五卷
6. 第六卷
7. 第七卷
8. 第6.5卷
9. 第7.5卷
10. 第八卷
11. 第九卷
12. 第十卷
13. 第10.5卷
14. 第十一卷
15. 第二季BD特典 Another
16. 第十二卷
17. 第十三卷
18. 第十四卷
19. 第14.5卷

### 使用示例

```bash
# 爬取所有卷册（需要较长时间）
python main.py

# 爬取前5卷
python main.py -v "第一卷" "第二卷" "第三卷" "第四卷" "第五卷"

# 爬取特典卷册
python main.py -v "第6.5卷" "第7.5卷" "第10.5卷" "第14.5卷" "Another"

# 爬取最新几卷
python main.py -v "第十二卷" "第十三卷" "第十四卷" "第14.5卷"
```

## ⚙️ 配置说明

主要配置在 `utils/config.py` 文件中：

```python
# 反爬虫配置
MIN_DELAY = 1.0         # 最小延迟时间（秒）
MAX_DELAY = 3.0         # 最大延迟时间（秒）
MAX_RETRIES = 3         # 最大重试次数
TIMEOUT = 30            # 请求超时时间（秒）
```

**注意**：不建议修改延迟时间过短，以免对服务器造成压力。

## 📊 程序特性

### ✅ 已实现功能
- ✅ 完整内容抓取（章节文本 + 插图）
- ✅ EPUB格式输出（标准电子书格式）
- ✅ 反爬虫策略（随机延迟、User-Agent轮换）
- ✅ 错误处理和重试机制
- ✅ 详细日志记录
- ✅ 选择性爬取（支持指定卷册）
- ✅ 图片下载和嵌入
- ✅ 进度显示

### 📈 性能数据
- **第一卷测试结果**：
  - 章节数：9个
  - 图片数：40张
  - 处理时间：约70秒
  - EPUB文件大小：包含完整内容和图片

## 🔧 故障排除

### 常见问题

1. **网络连接失败**
   ```bash
   python main.py --test
   ```

2. **依赖包缺失**
   ```bash
   pip install -r requirements.txt
   playwright install chromium
   ```

3. **权限错误**
   - 确保有写入 `output/` 和 `data/` 目录的权限
   - Windows用户可能需要以管理员身份运行

4. **内存不足**
   - 程序已优化为逐个处理卷册
   - 如仍有问题，可分批爬取

### 日志查看

详细日志保存在 `logs/` 目录下：
```
logs/novel_crawler_YYYYMMDD_HHMMSS.log
```

## ⚠️ 重要提醒

### 法律和道德规范
- 🔒 **仅供学习研究**：本程序仅用于技术学习和个人研究
- 📚 **尊重版权**：请尊重原作者和出版社的版权
- 🚫 **禁止商用**：不得用于商业用途或大规模传播
- 📋 **遵守规则**：程序已内置合理的访问间隔

### 使用建议
- 🕐 **避开高峰期**：建议在网站访问量较低时运行
- 🐌 **控制频率**：已内置延迟机制，请勿修改为过于激进的参数
- 💾 **备份数据**：重要的EPUB文件请及时备份
- 🔍 **检查质量**：建议用电子书阅读器检查生成的EPUB文件

## 🎯 下一步操作

1. **测试单个卷册**：
   ```bash
   python main.py -v "第二卷"
   ```

2. **批量爬取**：
   ```bash
   python main.py -v "第一卷" "第二卷" "第三卷"
   ```

3. **爬取所有卷册**（需要较长时间）：
   ```bash
   python main.py
   ```

## 📞 技术支持

如遇到问题，请：
1. 查看 `logs/` 目录下的日志文件
2. 检查网络连接：`python main.py --test`
3. 确认依赖包安装：`pip list | grep -E "(playwright|ebooklib|beautifulsoup4)"`

---

**祝您使用愉快！** 📚✨
