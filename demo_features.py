"""
åŠŸèƒ½æ¼”ç¤ºè„šæœ¬
Feature demonstration script
"""

import os
from epub.epub_generator import EPUBGenerator
from utils.logger import logger

def create_demo_epub():
    """åˆ›å»ºæ¼”ç¤ºEPUBï¼Œå±•ç¤ºæ‰€æœ‰åŠŸèƒ½"""
    
    # åˆ›å»ºæ¼”ç¤ºæ•°æ®
    demo_volume_data = {
        'title': 'åŠŸèƒ½æ¼”ç¤ºå·',
        'chapters': [
            {
                'title': 'ç¬¬ä¸€ç«  æ–‡æœ¬æ ¼å¼æ¼”ç¤º',
                'content': '''è¿™æ˜¯ä¸€ä¸ªæ™®é€šæ®µè½ï¼Œç”¨æ¥å±•ç¤ºåŸºæœ¬çš„æ–‡æœ¬æ ¼å¼ã€‚

ã€Œè¿™æ˜¯ä¸€æ®µå¯¹è¯ï¼Œã€ä¸»è§’è¯´é“ï¼Œã€Œåº”è¯¥ä¼šä»¥ç‰¹æ®Šçš„æ ·å¼æ˜¾ç¤ºã€‚ã€

ï¼ˆè¿™æ˜¯å†…å¿ƒç‹¬ç™½ï¼Œé€šå¸¸ç”¨æ‹¬å·è¡¨ç¤ºã€‚ï¼‰

**è¿™æ˜¯ç²—ä½“æ–‡æœ¬**ï¼Œ*è¿™æ˜¯æ–œä½“æ–‡æœ¬*ã€‚

ã€Šè¿™æ˜¯ä¹¦åã€‹ï¼Œã€è¿™æ˜¯ç‰¹æ®Šå¼ºè°ƒã€‘ã€‚

â€» è¿™æ˜¯æ—ç™½æˆ–æ³¨é‡Šæ–‡æœ¬ â€»

â€”â€”è¿™ä¹Ÿæ˜¯ä¸€ç§å†…å¿ƒç‹¬ç™½çš„è¡¨ç¤ºæ–¹å¼â€”â€”

è¿™æ˜¯å¦ä¸€ä¸ªæ™®é€šæ®µè½ï¼Œç”¨æ¥æµ‹è¯•æ®µè½é—´çš„é—´è·å’Œæ’ç‰ˆæ•ˆæœã€‚æ–‡æœ¬åº”è¯¥è‡ªåŠ¨å¯¹é½ï¼Œå¹¶ä¸”æœ‰é€‚å½“çš„è¡Œé—´è·ã€‚

"è¿™æ˜¯å¦ä¸€ç§å¯¹è¯æ ¼å¼ï¼Œ"å¦ä¸€ä¸ªè§’è‰²å›åº”é“ã€‚

1. è¿™å¯èƒ½æ˜¯ä¸€ä¸ªå°æ ‡é¢˜

è¿™æ˜¯å°æ ‡é¢˜ä¸‹çš„å†…å®¹ï¼Œåº”è¯¥æœ‰ä¸åŒçš„æ ¼å¼ã€‚

â˜… ç‰¹æ®Šæ ‡è®°çš„æ–‡æœ¬ â˜…

æœ€åä¸€ä¸ªæ®µè½ï¼Œç”¨æ¥ç»“æŸè¿™ä¸ªæ¼”ç¤ºç« èŠ‚ã€‚''',
                'url': 'demo1.htm'
            },
            {
                'title': 'ç¬¬äºŒç«  æ›´å¤šæ ·å¼æµ‹è¯•',
                'content': '''è¿™ä¸€ç« ç»§ç»­å±•ç¤ºæ›´å¤šçš„æ–‡æœ¬æ ·å¼å’Œæ ¼å¼ã€‚

ã€Œä½ è§‰å¾—è¿™ä¸ªæ ¼å¼æ€ä¹ˆæ ·ï¼Ÿã€é›ªä¹ƒé—®é“ã€‚

ï¼ˆçœ‹èµ·æ¥è¿˜ä¸é”™ï¼Œï¼‰å…«å¹¡å¿ƒæƒ³ï¼Œï¼ˆè‡³å°‘æ¯”ä¹‹å‰çš„ç‰ˆæœ¬å¥½å¤šäº†ã€‚ï¼‰

**é‡è¦æç¤º**ï¼šè¿™ä¸ªEPUBç”Ÿæˆå™¨ç°åœ¨æ”¯æŒï¼š
- æ™ºèƒ½æ®µè½è¯†åˆ«
- å¯¹è¯æ ¼å¼åŒ–
- å†…å¿ƒç‹¬ç™½æ ·å¼
- æ—ç™½å’Œæ³¨é‡Š
- å›¾ç‰‡åµŒå…¥
- å“åº”å¼è®¾è®¡
- æ·±è‰²æ¨¡å¼æ”¯æŒ

*è¿™äº›åŠŸèƒ½*è®©é˜…è¯»ä½“éªŒæ›´åŠ èˆ’é€‚å’Œä¸“ä¸šã€‚

ã€Œç¡®å®å¦‚æ­¤ï¼Œã€ç»“è¡£é™„å’Œé“ï¼Œã€Œç°åœ¨çœ‹èµ·æ¥å°±åƒçœŸæ­£çš„ç”µå­ä¹¦äº†ã€‚ã€

â€» ä½œè€…æ³¨ï¼šè¿™ä¸ªæ¼”ç¤ºå±•ç¤ºäº†å„ç§æ–‡æœ¬æ ¼å¼çš„å¤„ç†èƒ½åŠ› â€»

__ä¸‹åˆ’çº¿å¼ºè°ƒ__ä¹Ÿæ˜¯æ”¯æŒçš„æ ¼å¼ä¹‹ä¸€ã€‚

ã€Šè½»å°è¯´çˆ¬è™«é¡¹ç›®ã€‹ç°åœ¨å·²ç»å…·å¤‡äº†å®Œæ•´çš„åŠŸèƒ½ã€‚

æœ€ç»ˆæ®µè½ï¼šæ„Ÿè°¢æ‚¨ä½¿ç”¨è¿™ä¸ªçˆ¬è™«ç¨‹åºï¼''',
                'url': 'demo2.htm'
            }
        ],
        'images': []  # æ¼”ç¤ºç‰ˆæœ¬ä¸åŒ…å«å›¾ç‰‡
    }
    
    try:
        generator = EPUBGenerator()
        epub_path = generator.create_epub(demo_volume_data)
        logger.info(f"æ¼”ç¤ºEPUBç”ŸæˆæˆåŠŸ: {epub_path}")
        
        print("\n" + "="*60)
        print("ğŸ‰ åŠŸèƒ½æ¼”ç¤ºEPUBç”ŸæˆæˆåŠŸï¼")
        print("="*60)
        print(f"ğŸ“ æ–‡ä»¶ä½ç½®: {epub_path}")
        print("\nğŸ“– æ–°åŠŸèƒ½ç‰¹æ€§:")
        print("âœ… æ™ºèƒ½æ–‡æœ¬æ ¼å¼è¯†åˆ«")
        print("âœ… å¯¹è¯æ ·å¼ä¼˜åŒ–")
        print("âœ… å†…å¿ƒç‹¬ç™½æ ¼å¼")
        print("âœ… æ—ç™½å’Œæ³¨é‡Šæ ·å¼")
        print("âœ… å¼ºè°ƒæ–‡æœ¬å¤„ç†")
        print("âœ… ä¸“ä¸šCSSæ ·å¼")
        print("âœ… å“åº”å¼è®¾è®¡")
        print("âœ… æ·±è‰²æ¨¡å¼æ”¯æŒ")
        print("âœ… å›¾ç‰‡åµŒå…¥åŠŸèƒ½")
        print("âœ… ä¼˜é›…çš„æ’ç‰ˆ")
        print("\nğŸ” å»ºè®®ä½¿ç”¨ç”µå­ä¹¦é˜…è¯»å™¨æ‰“å¼€æŸ¥çœ‹æ•ˆæœ")
        print("æ¨èé˜…è¯»å™¨: Calibre, Adobe Digital Editions, Apple Books")
        
        return True
    except Exception as e:
        logger.error(f"æ¼”ç¤ºEPUBç”Ÿæˆå¤±è´¥: {str(e)}")
        import traceback
        traceback.print_exc()
        return False

def show_file_structure():
    """æ˜¾ç¤ºé¡¹ç›®æ–‡ä»¶ç»“æ„"""
    print("\n" + "="*60)
    print("ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„")
    print("="*60)
    
    structure = """
PythonProject_GetFiction/
â”œâ”€â”€ ğŸ“„ main.py                     # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ ğŸ“„ install.py                  # å®‰è£…è„šæœ¬
â”œâ”€â”€ ğŸ“„ test_epub.py               # EPUBæµ‹è¯•è„šæœ¬
â”œâ”€â”€ ğŸ“„ demo_features.py           # åŠŸèƒ½æ¼”ç¤ºè„šæœ¬
â”œâ”€â”€ ğŸ“„ requirements.txt           # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ ğŸ“„ README.md                  # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ ğŸ“„ ä½¿ç”¨æŒ‡å—.md                # ä¸­æ–‡ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ ğŸ“ crawler/                   # çˆ¬è™«æ ¸å¿ƒæ¨¡å—
â”‚   â”œâ”€â”€ ğŸ“„ novel_crawler.py       # ä¸»çˆ¬è™«ç±»
â”‚   â”œâ”€â”€ ğŸ“„ page_parser.py         # é¡µé¢è§£æå™¨
â”‚   â””â”€â”€ ğŸ“„ anti_crawler.py        # åçˆ¬è™«ç­–ç•¥
â”œâ”€â”€ ğŸ“ epub/                      # EPUBç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ ğŸ“„ epub_generator.py      # EPUBç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ ğŸ“„ enhanced_styles.py     # å¢å¼ºæ ·å¼
â”‚   â””â”€â”€ ğŸ“„ content_processor.py   # å†…å®¹å¤„ç†å™¨
â”œâ”€â”€ ğŸ“ utils/                     # å·¥å…·æ¨¡å—
â”‚   â”œâ”€â”€ ğŸ“„ config.py              # é…ç½®ç®¡ç†
â”‚   â””â”€â”€ ğŸ“„ logger.py              # æ—¥å¿—è®°å½•
â”œâ”€â”€ ğŸ“ output/                    # EPUBè¾“å‡ºç›®å½•
â”‚   â”œâ”€â”€ ğŸ“š æˆ‘çš„é’æ˜¥æ‹çˆ±ç‰©è¯­æœç„¶æœ‰é—®é¢˜_ç¬¬ä¸€å·.epub
â”‚   â””â”€â”€ ğŸ“š åŠŸèƒ½æ¼”ç¤ºå·.epub
â”œâ”€â”€ ğŸ“ data/images/               # ä¸‹è½½çš„å›¾ç‰‡
â””â”€â”€ ğŸ“ logs/                      # æ—¥å¿—æ–‡ä»¶
"""
    
    print(structure)

def show_usage_examples():
    """æ˜¾ç¤ºä½¿ç”¨ç¤ºä¾‹"""
    print("\n" + "="*60)
    print("ğŸš€ ä½¿ç”¨ç¤ºä¾‹")
    print("="*60)
    
    examples = """
# åŸºæœ¬ä½¿ç”¨
python main.py                              # çˆ¬å–æ‰€æœ‰å·å†Œ
python main.py --test                       # æµ‹è¯•ç½‘ç»œè¿æ¥
python main.py --volumes "ç¬¬ä¸€å·"           # çˆ¬å–æŒ‡å®šå·å†Œ

# æ‰¹é‡çˆ¬å–
python main.py -v "ç¬¬ä¸€å·" "ç¬¬äºŒå·" "ç¬¬ä¸‰å·"  # çˆ¬å–å¤šä¸ªå·å†Œ
python main.py -v "ç¬¬6.5å·" "ç¬¬7.5å·"       # çˆ¬å–ç‰¹å…¸å·å†Œ

# åŠŸèƒ½æµ‹è¯•
python test_epub.py                         # æµ‹è¯•EPUBç”Ÿæˆ
python demo_features.py                     # ç”ŸæˆåŠŸèƒ½æ¼”ç¤º

# å®‰è£…å’Œè®¾ç½®
python install.py                           # è‡ªåŠ¨å®‰è£…ä¾èµ–
pip install -r requirements.txt             # æ‰‹åŠ¨å®‰è£…ä¾èµ–
playwright install chromium                 # å®‰è£…æµè§ˆå™¨
"""
    
    print(examples)

def main():
    """ä¸»å‡½æ•°"""
    print("ğŸ¨ è½»å°è¯´çˆ¬è™« - åŠŸèƒ½æ¼”ç¤º")
    print("="*60)
    
    # æ˜¾ç¤ºé¡¹ç›®ç»“æ„
    show_file_structure()
    
    # æ˜¾ç¤ºä½¿ç”¨ç¤ºä¾‹
    show_usage_examples()
    
    # è¯¢é—®æ˜¯å¦ç”Ÿæˆæ¼”ç¤ºEPUB
    try:
        response = input("\næ˜¯å¦ç”ŸæˆåŠŸèƒ½æ¼”ç¤ºEPUBæ–‡ä»¶? (y/n): ").lower().strip()
        if response in ['y', 'yes', 'æ˜¯', '1']:
            create_demo_epub()
        else:
            print("è·³è¿‡æ¼”ç¤ºEPUBç”Ÿæˆ")
    except KeyboardInterrupt:
        print("\n\nç¨‹åºè¢«ç”¨æˆ·ä¸­æ–­")
    
    print("\n" + "="*60)
    print("ğŸ“š æ„Ÿè°¢ä½¿ç”¨è½»å°è¯´çˆ¬è™«ç¨‹åºï¼")
    print("="*60)
    print("ğŸ”— é¡¹ç›®ç‰¹è‰²:")
    print("   â€¢ å®Œæ•´çš„è½»å°è¯´å†…å®¹æŠ“å–")
    print("   â€¢ ä¸“ä¸šçš„EPUBç”µå­ä¹¦ç”Ÿæˆ")
    print("   â€¢ æ™ºèƒ½çš„æ–‡æœ¬æ ¼å¼å¤„ç†")
    print("   â€¢ ä¼˜é›…çš„é˜…è¯»æ ·å¼è®¾è®¡")
    print("   â€¢ å®Œå–„çš„åçˆ¬è™«ç­–ç•¥")
    print("   â€¢ è¯¦ç»†çš„æ—¥å¿—è®°å½•")
    print("\nâš ï¸  è¯·éµå®ˆç›¸å…³æ³•å¾‹æ³•è§„ï¼Œä»…ä¾›å­¦ä¹ ç ”ç©¶ä½¿ç”¨")

if __name__ == "__main__":
    main()
